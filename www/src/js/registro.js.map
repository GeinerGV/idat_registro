{"version":3,"sources":["../scripts/registro.jsx"],"names":["Distrito","props","nombre","patterns","dni","telefono","distrito","val","Registro","state","fullname","token_registros","token_inicial","mod_cliente","asesor","handleInput","bind","handleSubmit","iniciar","asesor_ref","ASESOR_REF","React","createRef","current","value","trim","$","removeAttr","setState","attr","xmlhttp","XMLHttpRequest","tmp_this","onreadystatechange","readyState","status","data","JSON","parse","responseText","show","open","send","document","getElementById","reset","hide","handleAsesorChange","removeClass","focus","event","target","id","test","RegExp","setSuccess","searchDNI","setError","setWarning","split","map","name","charAt","toUpperCase","substring","length","toLowerCase","join","setValidator","distritos","some","dist","preventDefault","params","alert","prepend","Alerta","token","tipo","setRequestHeader","panel","Component","RegistroManager","xmlhttp2","REGISTRO_REF","ReactDOM","render","querySelector"],"mappings":"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","file":"registro.js","sourcesContent":["function Distrito(props) {\n\treturn (\n\t\t<option value={props.nombre} />\n\t);\n}\n\nlet patterns = {\n\tdni: \"[0-9]{8}\",\n\ttelefono: \"^(?:9\\\\d{8}|[0-8]\\\\d{6})$\",\n\tdistrito: function (val) {\n\t\t/* let result = false;\n\t\tlet datalist = document.getElementById(\"distritos\");\n\t\tfor (let i = 0; i < datalist.options.length; i++) {\n\t\t\tresult =  val == datalist.options[i].value;\n\t\t\tif(result) break;\n\t\t}\n\t\treturn result; */\n\t\t//return this.props.distritos.some((dist) => val == dist);\n\t}\n}\n\nclass Registro extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {dni: '', fullname: '', telefono: '', distrito: '', token_registros: props.token_inicial, mod_cliente: null, asesor: null};\n\t\tthis.handleInput = this.handleInput.bind(this);\n\t\tthis.handleSubmit = this.handleSubmit.bind(this);\n\t\t//this.handleAsesorChange = this.handleAsesorChange.bind(this);\n\t\tthis.iniciar = this.iniciar.bind(this);\n\t\tthis.asesor_ref = ASESOR_REF;\n\t\tthis.dni = React.createRef();\n\t\tthis.fullname = React.createRef();\n\t\tthis.telefono = React.createRef();\n\t\tthis.distrito = React.createRef();\n\t}\n\n\thandleAsesorChange() {\n\t\tif (this.asesor_ref.current && this.asesor_ref.current.value.trim()) {\n\t\t\t$(\"#dni, #telefono, #fullname, #distrito\").removeAttr(\"disabled\");\n\t\t\tthis.setState({ asesor: this.asesor_ref.current.value.trim() });\n\t\t} else {\n\t\t\t$(\"#dni, #telefono, #fullname, #distrito\").attr(\"disabled\", \"true\");\n\t\t\tthis.setState({ asesor: null });\n\t\t}\n\t}\n\n\tsearchDNI(val) {\n\t\tlet xmlhttp = new XMLHttpRequest();\n\t\tlet tmp_this = this;\n\t\txmlhttp.onreadystatechange = function() {\n\t\t\tif (this.readyState == 4 && this.status == 200) {\n\t\t\t\tlet data = JSON.parse(this.responseText);\n\t\t\t\tif (typeof data.dni != 'undefined') {\n\t\t\t\t\ttmp_this.setState({ fullname: data.fullname, distrito: data.distrito, telefono: data.telefono ? data.telefono : '', mod_cliente: false});\n\t\t\t\t\t$(\"#fullname\").val(data.fullname);\n\t\t\t\t\t$(\"#distrito\").val(data.distrito);\n\t\t\t\t\t$(\"#telefono\").val(data.telefono);\n\t\t\t\t\t$(\"#telefono, #fullname, #distrito\").show();\n\t\t\t\t\t$(\"#telefono, #fullname, #distrito\").attr(\"readonly\", \"true\");\n\t\t\t\t} else {\n\t\t\t\t\tif (typeof tmp_this.state.mod_cliente == 'boolean') {\n\t\t\t\t\t\ttmp_this.setState({mod_cliente: null});\n\t\t\t\t\t\t$(\"#telefono, #fullname, #distrito\").val(\"\");\n\t\t\t\t\t\t$(\"#telefono, #fullname, #distrito\").removeAttr(\"readonly\");\n\t\t\t\t\t}\n\t\t\t\t\t$(\"#fullname\").show();\n\t\t\t\t\tif ($(\"#distrito\").val()) $(\"#distrito\").show();\n\t\t\t\t\tif ($(\"#telefono\").val()) $(\"#telefono\").show();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\txmlhttp.open(\"GET\", \"/registro?client=get&json=true&dni=\" + val, true);\n\t\txmlhttp.send();\n\t}\n\n\tiniciar() {\n\t\tdocument.getElementById(\"form-registro\").reset();\n\t\t$(\"#telefono, #fullname, #distrito\").hide();\n\t\tthis.handleAsesorChange();\n\t\t$(\".form-group\").removeClass('has-warning has-success has-error');\n\t\t$(\"#dni\").focus();\n\t}\n\n\thandleInput(event) {\n\t\tlet val = event.target.value;\n\t\tswitch (event.target.id) {\n\t\t\tcase \"dni\":\n\t\t\t\tif (/^\\d{0,8}$/.test(val)) {\n\t\t\t\t\tthis.setState({dni: val});\n\t\t\t\t\tif (val) {\n\t\t\t\t\t\tif (new RegExp(patterns.dni).test(val)) {\n\t\t\t\t\t\t\tsetSuccess(event);\n\t\t\t\t\t\t\tthis.searchDNI(val);\n\t\t\t\t\t\t\t$(\"#telefono, #fullname, #distrito\").show();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetError(event);\n\t\t\t\t\t\t\t$(\"#telefono, #fullname, #distrito\").hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetWarning(event);\n\t\t\t\t\t\t$(\"#telefono, #fullname, #distrito\").hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"fullname\":\n\t\t\t\t// https://regex101.com/r/mFnoYm/1\n\t\t\t\tif (/^[a-zA-Z]+(?:[ ][a-zA-Z]+)*[ ]?$|^$/.test(val)) {\n\t\t\t\t\tif (val) {\n\t\t\t\t\t\tval = val.split(' ').map((name) => (\n\t\t\t\t\t\t\tname && name.charAt(0).toUpperCase() + name.substring(1, val.length).toLowerCase()\n\t\t\t\t\t\t)).join(' ');\n\t\t\t\t\t\tif (val.length>=3) {\n\t\t\t\t\t\t\tsetSuccess(event);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetError(event);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetWarning(event);\n\t\t\t\t\t}\n\t\t\t\t\tthis.setState({fullname: val});\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"telefono\":\n\t\t\t\tif (/^(?:9\\d{0,8}|\\d{0,7})$/.test(val)) {\n\t\t\t\t\tthis.setState({telefono: val});\n\t\t\t\t\tif (val) {\n\t\t\t\t\t\tif (new RegExp(patterns.telefono).test(val)) {\n\t\t\t\t\t\t\tsetSuccess(event);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetError(event);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetValidator(event, \"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"distrito\":\n\t\t\t\tif (this.props.distritos.some((dist) => new RegExp(`^.*${val}.*$`, 'i').test(dist))) {\n\t\t\t\t\tthis.setState({distrito: val.toUpperCase()});\n\t\t\t\t\tif (val) {\n\t\t\t\t\t\tif (this.props.distritos.some((dist) => new RegExp(`^${val}$`, 'i').test(dist))) {\n\t\t\t\t\t\t\tsetSuccess(event);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetError(event);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetWarning(event);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\thandleSubmit(event) {\n\t\tevent.preventDefault();\n\t\tif (this.state.dni && this.state.fullname && this.state.distrito) {\n\t\t\tlet asesor = this.asesor_ref.current.value;\n\t\t\tif (asesor) {\n\t\t\t\tlet xmlhttp = new XMLHttpRequest();\n\t\t\t\tlet params = `dni=${this.state.dni}&token_registros=${this.state.token_registros}&asesor=${asesor}`;\n\t\t\t\tif (this.state.fullname) params += `&fullname=${this.state.fullname.trim()}`;\n\t\t\t\tif (this.state.telefono) params += `&telefono=${this.state.telefono}`;\n\t\t\t\tif (this.state.distrito) params += `&distrito=${this.state.distrito}`;\n\t\t\t\tif (this.state.mod_cliente) params += `&mod_cliente=${this.state.mod_cliente}`;\n\t\t\t\t//if (this.state.asesor) params += `&asesor=${this.state.asesor}`;\n\t\t\t\tlet tmp_this = this;\n\t\t\t\txmlhttp.onreadystatechange = function() {\n\t\t\t\t\tif (this.readyState == 4 && this.status == 200) {\n\t\t\t\t\t\tlet data = JSON.parse(this.responseText);\n\t\t\t\t\t\t$('.alert').alert('close');\n\t\t\t\t\t\t$(\"#registro-cnt\").prepend(Alerta(data));\n\t\t\t\t\t\ttmp_this.setState({token_registros: data.token});\n\t\t\t\t\t\tif (data.tipo == 'success') {\n\t\t\t\t\t\t\ttmp_this.iniciar();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\txmlhttp.open(\"POST\", \"/registro\", true);\n\t\t\t\txmlhttp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n\t\t\t\txmlhttp.send(params);\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentDidMount () {\n\t\tthis.iniciar();\n\t}\n\n\trender() {\n\t\tlet distritos = this.props.distritos.map(distrito => <Distrito nombre={distrito} key={distrito} />);\n\t\treturn (\n\t\t\t<form id=\"form-registro\" className=\"form-horizontal\" onSubmit={this.handleSubmit} onReset={this.iniciar}>\n\t\t\t\t<div className={\"panel panel-\"+this.state.panel}>\n\t\t\t\t\t<div className=\"panel-heading\">\n\t\t\t\t\t\t<h3 className=\"panel-title text-center text-uppercase\">BIENVENIDO: <strong>{this.state.asesor}</strong></h3>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"panel-body\">\n\t\t\t\t\t\t<div className=\"form-group\">\n\t\t\t\t\t\t\t<label htmlFor=\"dni\" className=\"col-sm-2 control-label\">DNI</label>\n\t\t\t\t\t\t\t<div className=\"col-sm-10\">\n\t\t\t\t\t\t\t\t<input type=\"text\" pattern={patterns.dni} onChange={this.handleInput} className=\"form-control\" ref={this.dni} id=\"dni\" name=\"dni\" placeholder=\"Ingresa el DNI (i.e. 87654321)\" minLength={8} maxLength={8} required={true} value={this.state.dni} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"form-group\">\n\t\t\t\t\t\t\t<label htmlFor=\"fullname\" className=\"col-sm-2 control-label\">NOMBRE Y APELLIDO</label>\n\n\t\t\t\t\t\t\t<div className=\"col-sm-10\">\n\t\t\t\t\t\t\t\t<input type=\"text\" onChange={this.handleInput} className=\"form-control\" ref={this.fullname} id=\"fullname\" name=\"fullname\" placeholder=\"Escribe un nombre\" required={true} value={this.state.fullname} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"form-group\">\n\t\t\t\t\t\t\t<label htmlFor=\"distrito\" className=\"col-sm-2 control-label\">DISTRITO</label>\n\t\t\t\t\t\t\t<div className=\"col-sm-10\">\n\t\t\t\t\t\t\t\t<input type=\"text\" onChange={this.handleInput} className=\"form-control\" list=\"distritos\" ref={this.telefono} id=\"distrito\" name=\"distrito\"  placeholder=\"¿Dónde vives?\" required={true} value={this.state.distrito} />\n\t\t\t\t\t\t\t\t<datalist name=\"distritos\" id=\"distritos\">\n\t\t\t\t\t\t\t\t\t{distritos}\n\t\t\t\t\t\t\t\t</datalist>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"form-group\">\n\t\t\t\t\t\t\t<label htmlFor=\"telefono\" className=\"col-sm-2 control-label\">TELÉFONO</label>\n\t\t\t\t\t\t\t<div className=\"col-sm-10\">\n\t\t\t\t\t\t\t\t<input type=\"text\" onChange={this.handleInput} className=\"form-control\" ref={this.distrito} id=\"telefono\" name=\"telefono\" placeholder=\"Digita el número (opcional)\" pattern={patterns.telefono} minLength={7} maxLength={12} value={this.state.telefono} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"panel-footer\">\n\t\t\t\t\t\t<div className=\"btn-group btn-group-justified\" role=\"group\" aria-label=\"...\">\n\t\t\t\t\t\t\t<div className=\"btn-group\" role=\"group\">\n\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"toke_inicial\" name=\"token\" value={this.state.token_registros} />\n\t\t\t\t\t\t\t\t<button type=\"reset\" id=\"reset-form\" className=\"btn btn-default\">LIMPIAR</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"btn-group\" role=\"group\">\n\t\t\t\t\t\t\t\t<button type=\"submit\" className=\"btn btn-primary\">GRABAR</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t);\n\t}\n}\n\nclass RegistroManager extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {distritos: [], token_inicial: ''};\n\t}\n\n\tcomponentDidMount() {\n\t\tlet tmp_this = this;\n\t\tlet xmlhttp = new XMLHttpRequest();\n\t\txmlhttp.onreadystatechange = function() {\n\t\t\tif (this.readyState == 4 && this.status == 200) {\n\t\t\t\tlet data = JSON.parse(this.responseText);\n\t\t\t\ttmp_this.setState({distritos: data.distritos});\n\t\t\t}\n\t\t};\n\t\txmlhttp.open(\"GET\", \"/registro?distritos=get&json=true\", true);\n\t\txmlhttp.send();\n\t\tlet xmlhttp2 = new XMLHttpRequest();\n\t\txmlhttp2.onreadystatechange = function() {\n\t\t\tif (this.readyState == 4 && this.status == 200) {\n\t\t\t\tlet data = JSON.parse(this.responseText);\n\t\t\t\ttmp_this.setState({token_inicial: data.token});\n\t\t\t}\n\t\t};\n\t\txmlhttp2.open(\"GET\", \"/registro?token=get&json=true\", true);\n\t\txmlhttp2.send();\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Registro {...this.state} key={this.state.token_inicial} ref={REGISTRO_REF} />\n\t\t);\n\t}\n}\n\n$(\n\tReactDOM.render(<RegistroManager />, document.querySelector(\"#registro-cnt\"))\n);\n"]}