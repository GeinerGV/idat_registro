var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var AdminRows=function(_React$Component){_inherits(AdminRows,_React$Component);function AdminRows(props){_classCallCheck(this,AdminRows);var _this=_possibleConstructorReturn(this,(AdminRows.__proto__||Object.getPrototypeOf(AdminRows)).call(this,props));_this.state={tipo:"info",accion:"Aceptar",msg:"..."};_this.handleDelete=_this.handleDelete.bind(_this);_this.handleEdit=_this.handleEdit.bind(_this);_this.handleConfirm=_this.handleConfirm.bind(_this);_this.handleCancel=_this.handleCancel.bind(_this);return _this}_createClass(AdminRows,[{key:"handleDelete",value:function handleDelete(e){this.setState({tipo:"danger",accion:"Borrar",msg:"\xBFEst\xE1 seguro que desea eliminar esta fila?"});DATOS_REF.current.setRowTipo("danger");$("#modalConfirm").modal("show")}},{key:"addDeleteWaitingResponse",value:function addDeleteWaitingResponse(){var newDeleteWaitingResponse=[{pos:DATOS_REF.current.state.selectedRow,data:DATOS_REF.current.getRows()[DATOS_REF.current.state.selectedRow]}];var deleteWaitingResponse=DATOS_REF.current.state.deleteWaitingResponse?newDeleteWaitingResponse.concat(DATOS_REF.current.state.deleteWaitingResponse):newDeleteWaitingResponse;DATOS_REF.current.setState({deleteWaitingResponse:deleteWaitingResponse})}},{key:"handleEdit",value:function handleEdit(e){this.setState({tipo:"warning",accion:"Editar",msg:"\xBFEst\xE1 seguro que desea editar esta fila?"});DATOS_REF.current.setRowTipo("warning");$("#modalConfirm").modal("show")}},{key:"handleConfirm",value:function handleConfirm(e){switch(this.state.accion){case"Borrar":var rows=DATOS_REF.current.getCurrRowsSource();delete rows[rows[DATOS_REF.current.state.selectedRow][0]];DATOS_REF.current.setCurrRowsSource(rows);var newDeleteWaitingResponse=[{pos:DATOS_REF.current.state.selectedRow,data:DATOS_REF.current.getRows()[DATOS_REF.current.state.selectedRow]}];var deleteWaitingResponse=DATOS_REF.current.state.deleteWaitingResponse?newDeleteWaitingResponse.concat(DATOS_REF.current.state.deleteWaitingResponse):newDeleteWaitingResponse;DATOS_REF.current.setState({deleteWaitingResponse:deleteWaitingResponse});var newState={};if(DATOS_REF.current.state.selectedRow==DATOS_REF.current.getRows().length-1&&DATOS_REF.current.state.selectedRow>0)newState.selectedRow=DATOS_REF.current.state.selectedRow-1;DATOS_REF.current.setState(newState);var xmlhttp=new XMLHttpRequest;var params="remove=true&idRow="+newDeleteWaitingResponse[0].data[0];xmlhttp.onreadystatechange=function(){if(this.readyState==4&&this.status==200){if(this.status==200){var data=JSON.parse(this.responseText);if(data.idRemove){$("#datos-cnt").prepend(Alerta({tipo:"success",msg:"Borrado exitosamente"}));var tmp_deleteWaitingResponse=DATOS_REF.current.state.deleteWaitingResponse;var tmp_idx=tmp_deleteWaitingResponse.findIndex(function(val,idx){return data.idRemove==val.data[0]});delete tmp_deleteWaitingResponse[tmp_idx].data;DATOS_REF.current.setState({deleteWaitingResponse:tmp_deleteWaitingResponse})}else{$("#datos-cnt").prepend(Alerta({tipo:"danger",msg:"No se pudo elimanar el registro, recargue e int\xE9ntelo nuevamente"}))}}DATOS_REF.current.setState({deleteResponse:DATOS_REF.current.state.deleteResponse?DATOS_REF.current.state.deleteResponse+1:1});if(DATOS_REF.current.state.deleteResponse==DATOS_REF.current.state.deleteWaitingResponse.length){var posiciones=DATOS_REF.current.state.deleteWaitingResponse.map(function(val){return val.pos}),tmp_rows=DATOS_REF.current.getRows();DATOS_REF.current.state.deleteWaitingResponse.forEach(function(val,idx){posiciones.slice(idx+1,posiciones.length).forEach(function(val2,idx2){if(posiciones[idx]<posiciones[idx+1+idx2])posiciones[idx+1+idx2]+=1});if(val.data)tmp_rows.splice(posiciones[idx],0,val.data)});DATOS_REF.current.setState({deleteWaitingResponse:[],deleteResponse:0});DATOS_REF.current.setCurrRowsSource(tmp_rows)}}};xmlhttp.open("POST","/datos?json=true",true);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlhttp.send(params);break;case"Editar":break;}$("#modalConfirm").modal("hide")}},{key:"handleCancel",value:function handleCancel(e){}},{key:"componentDidMount",value:function componentDidMount(){$("#modalConfirm").on("hidden.bs.modal",function(e){DATOS_REF.current.setRowTipo("active")})}},{key:"render",value:function render(){var posY=this.props.posY;return React.createElement(React.Fragment,null,React.createElement("div",{className:"edit-tbl-row btn-toolbar",role:"toolbar",style:{transform:"translateY("+posY+"px)"}},React.createElement("div",{className:"btn-group btn-group-sm",role:"group","aria-label":"Modificar el registro de atenci\xF3n",style:{display:"flex"}},React.createElement("button",{type:"button",title:"Borrar atenci\xF3n",onClick:this.handleDelete,className:"btn btn-danger",style:{borderTopRightRadius:0,borderBottomRightRadius:0}},"Borrar ",React.createElement("span",{className:"glyphicon glyphicon-remove","aria-label":"Borrar fila"})))),React.createElement(ModalCnt,null,React.createElement(ModalConfirm,Object.assign({handleConfirm:this.handleConfirm,handleCancel:this.handleCancel},this.state))))}}]);return AdminRows}(React.Component);var modalRoot=document.getElementById("modal-root");var ModalCnt=function(_React$Component2){_inherits(ModalCnt,_React$Component2);function ModalCnt(props){_classCallCheck(this,ModalCnt);var _this2=_possibleConstructorReturn(this,(ModalCnt.__proto__||Object.getPrototypeOf(ModalCnt)).call(this,props));_this2.el=document.createElement("div");return _this2}_createClass(ModalCnt,[{key:"componentDidMount",value:function componentDidMount(){modalRoot.appendChild(this.el)}},{key:"componentWillUnmount",value:function componentWillUnmount(){modalRoot.removeChild(this.el)}},{key:"render",value:function render(){return ReactDOM.createPortal(this.props.children,this.el)}}]);return ModalCnt}(React.Component);function ModalConfirm(props){return React.createElement("div",{className:"modal fade",id:"modalConfirm",tabIndex:"-1",role:"dialog","aria-labelledby":"modalConfirmLabel"},React.createElement("div",{className:"modal-dialog",role:"document"},React.createElement("div",{className:"modal-content"},React.createElement("div",{className:"modal-header"},React.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},React.createElement("span",{"aria-hidden":"true"},"\xD7")),React.createElement("h4",{className:"modal-title",id:"modalConfirmLabel"},"Alerta de confirmaci\xF3n")),React.createElement("div",{className:"modal-body"},React.createElement("strong",null,props.msg)),React.createElement("div",{className:"modal-footer"},React.createElement("button",{type:"button",onClick:props.handleCancel,className:"btn btn-default","data-dismiss":"modal"},"Cancelar"),React.createElement("button",{type:"button",onClick:props.handleConfirm,className:"btn btn-"+props.tipo},props.accion)))))}$(window).resize(function(){if(DATOS_REF.current){DATOS_REF.current.setTableHeight()}});
//# sourceMappingURL=editor-datos.js.map